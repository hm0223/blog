(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{339:function(t,s,a){"use strict";a.r(s);var n=a(5),p=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"_1、异步查询工具axios"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、异步查询工具axios"}},[t._v("#")]),t._v(" 1、异步查询工具axios")]),t._v(" "),s("p",[t._v("异步查询数据，自然是通过ajax查询，大家首先想起的肯定是jQuery。但jQuery与MVVM的思想不吻合，而且ajax只是jQuery的一小部分。因此不可能为了发起ajax请求而去引用这么大的一个库。")]),t._v(" "),s("h3",{attrs:{id:"_1-1axios入门"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1axios入门"}},[t._v("#")]),t._v(" 1.1axios入门")]),t._v(" "),s("p",[t._v("Vue官方推荐的ajax请求框架叫做：axios，看下demo：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526033988251.png",alt:"1526033988251"}})]),t._v(" "),s("p",[t._v("axios的Get请求语法：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("axios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/item/category/list?pid=0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 请求路径和请求参数拼接")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 成功回调函数")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 失败回调函数")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 参数较多时，可以通过params来传递参数")]),t._v("\naxios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/item/category/list"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("params")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("pid")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 成功时的回调")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 失败时的回调")]),t._v("\n")])])]),s("p",[t._v("axios的POST请求语法：")]),t._v(" "),s("p",[t._v("比如新增一个用户")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("axios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/user"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Jack"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    \t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("age")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("ul",[s("li",[t._v("注意，POST请求传参，不需要像GET请求那样定义一个对象，在对象的params参数中传参。post()方法的第二个参数对象，就是将来要传递的参数")])]),t._v(" "),s("p",[t._v("PUT和DELETE请求与POST请求类似")]),t._v(" "),s("h3",{attrs:{id:"_1-2axios的全局配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2axios的全局配置"}},[t._v("#")]),t._v(" 1.2axios的全局配置")]),t._v(" "),s("p",[t._v("而在我们的项目中，已经引入了axios，并且进行了简单的封装，在src下的http.js中：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526034150067.png",alt:"1526034150067"}})]),t._v(" "),s("p",[t._v("http.js中对axios进行了一些默认配置：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Vue "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" axios "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'axios'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" config "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./config'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// config中定义的基础路径是：http://api.leyou.com/api")]),t._v("\naxios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaults"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("baseURL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("api"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置axios的基础请求路径")]),t._v("\naxios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaults"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timeout "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置axios的请求时间")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$http "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" axios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将axios赋值给Vue原型的$http属性，这样所有vue实例都可使用该对象")]),t._v("\n\n")])])]),s("ul",[s("li",[s("p",[t._v("http.js中导入了config的配置，还记得吗？")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526041205846.png",alt:"1526041205846"}})])]),t._v(" "),s("li",[s("p",[t._v("http.js对axios进行了全局配置："),s("code",[t._v("baseURL=config.api")]),t._v("，即"),s("code",[t._v("http://api.leyou.com/api")]),t._v("。因此以后所有用axios发起的请求，都会以这个地址作为前缀。")])]),t._v(" "),s("li",[s("p",[t._v("通过"),s("code",[t._v("Vue.property.$http = axios")]),t._v("，将"),s("code",[t._v("axios")]),t._v("赋值给了 Vue原型中的"),s("code",[t._v("$http")]),t._v("。这样以后所有的Vue实例都可以访问到$http，也就是访问到了axios了。")])])]),t._v(" "),s("h3",{attrs:{id:"_1-3测试一下"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3测试一下"}},[t._v("#")]),t._v(" 1.3测试一下：")]),t._v(" "),s("p",[t._v("我们在组件"),s("code",[t._v("MyBrand.vue")]),t._v("的getDataFromServer方法，通过$http发起get请求，测试查询品牌的接口，看是否能获取到数据：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526048079191.png",alt:"1526048221750"}})]),t._v(" "),s("p",[t._v("网络监视：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526048143014.png",alt:"1526048143014"}})]),t._v(" "),s("p",[t._v("控制台结果：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526048275064.png",alt:"1526048275064"}})]),t._v(" "),s("p",[t._v("可以看到，在请求成功的返回结果response中，有一个data属性，里面就是真正的响应数据。")]),t._v(" "),s("p",[t._v("响应结果中与我们设计的一致，包含3个内容：")]),t._v(" "),s("ul",[s("li",[t._v("total：总条数，目前是165")]),t._v(" "),s("li",[t._v("items：当前页数据")]),t._v(" "),s("li",[t._v("totalPage：总页数，我们没有返回")])]),t._v(" "),s("h3",{attrs:{id:"_1-4异步加载品牌数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4异步加载品牌数据"}},[t._v("#")]),t._v(" 1.4异步加载品牌数据")]),t._v(" "),s("p",[t._v("虽然已经通过ajax请求获取了品牌数据，但是刚才的请求没有携带任何参数，这样显然不对。我们后端接口需要5个参数：")]),t._v(" "),s("ul",[s("li",[t._v("page：当前页，int")]),t._v(" "),s("li",[t._v("rows：每页大小，int")]),t._v(" "),s("li",[t._v("sortBy：排序字段，String")]),t._v(" "),s("li",[t._v("desc：是否为降序，boolean")]),t._v(" "),s("li",[t._v("key：搜索关键词，String")])]),t._v(" "),s("p",[t._v("而页面中分页信息应该是在pagination对象中，我们通过浏览器工具，查看pagination中有哪些属性：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526042136135.png",alt:""}})]),t._v(" "),s("p",[t._v("分别是：")]),t._v(" "),s("ul",[s("li",[t._v("descending：是否是降序，对应请求参数的desc")]),t._v(" "),s("li",[t._v("page：当前页，对应参数的page")]),t._v(" "),s("li",[t._v("rowsPerpage：每页大小，对应参数中的rows")]),t._v(" "),s("li",[t._v("sortBy：排序字段，对应参数的sortBy")])]),t._v(" "),s("p",[t._v("缺少一个搜索关键词，这个应该是通过v-model与输入框绑定的属性：search。这样，所有参数就都有了。")]),t._v(" "),s("p",[t._v("另外，不要忘了把查询的结果赋值给brands和totalBrands属性，Vuetify会帮我们渲染页面。")]),t._v(" "),s("p",[t._v("接下来，我们完善请求参数：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 发起请求")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/item/brand/page"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("params")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("search"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 搜索条件")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("page")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pagination"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当前页")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("rows")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pagination"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rowsPerPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 每页大小")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("sortBy")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pagination"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sortBy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 排序字段")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("desc")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pagination"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("descending"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 是否降序")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里使用箭头函数")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将得到的数据赋值给本地属性")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("brands "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" resp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("totalBrands "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" resp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("total"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 完成赋值后，把加载状态赋值为false")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("loading "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("查看网络请求：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526049810351.png",alt:"1526049810351"}})]),t._v(" "),s("p",[t._v("效果：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526049139244.png",alt:"1526049139244"}})]),t._v(" "),s("h2",{attrs:{id:"_2、请求参数格式错误"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、请求参数格式错误"}},[t._v("#")]),t._v(" 2、请求参数格式错误")]),t._v(" "),s("h3",{attrs:{id:"_2-1原因分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1原因分析"}},[t._v("#")]),t._v(" 2.1原因分析")]),t._v(" "),s("p",[t._v("我们填写表单并提交，发现报错了：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526180888663.png",alt:"1526180888663"}})]),t._v(" "),s("p",[t._v("查看控制台的请求详情：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526180937974.png",alt:"1526180937974"}})]),t._v(" "),s("p",[t._v("发现请求的数据格式是JSON格式。")]),t._v(" "),s("blockquote",[s("p",[t._v("原因分析：")])]),t._v(" "),s("p",[t._v("axios处理请求体的原则会根据请求数据的格式来定：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("如果请求体是对象：会转为json发送")])]),t._v(" "),s("li",[s("p",[t._v("如果请求体是String：会作为普通表单请求发送，但需要我们自己保证String的格式是键值对。")]),t._v(" "),s("p",[t._v("如：name=jack&age=12")])])]),t._v(" "),s("h3",{attrs:{id:"_2-2-qs工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-qs工具"}},[t._v("#")]),t._v(" 2.2.QS工具")]),t._v(" "),s("p",[t._v("QS是一个第三方库，我们可以用"),s("code",[t._v("npm install qs --save")]),t._v("来安装。不过我们在项目中已经集成了，大家无需安装：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526181889564.png",alt:"1526181889564"}})]),t._v(" "),s("p",[t._v("这个工具的名字：QS，即Query String，请求参数字符串。")]),t._v(" "),s("p",[t._v("什么是请求参数字符串？例如： name=jack&age=21")]),t._v(" "),s("p",[t._v("QS工具可以便捷的实现 JS的Object与QueryString的转换。")]),t._v(" "),s("p",[t._v("在我们的项目中，将QS注入到了Vue的原型对象中，我们可以通过"),s("code",[t._v("this.$qs")]),t._v("来获取这个工具：")]),t._v(" "),s("p",[t._v("我们将"),s("code",[t._v("this.$qs")]),t._v("对象打印到控制台：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("created")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$qs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("发现其中有3个方法：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526181747560.png",alt:"1526181747560"}})]),t._v(" "),s("p",[t._v("这里我们要使用的方法是stringify，它可以把Object转为QueryString。")]),t._v(" "),s("p",[t._v("测试一下，使用浏览器工具，把qs对象保存为一个临时变量：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526182053758.png",alt:"1526182053758"}})]),t._v(" "),s("p",[t._v("然后调用stringify方法：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526182230872.png",alt:"1526182230872"}})]),t._v(" "),s("p",[t._v("成功将person对象变成了 name=jack&age=21的字符串了")]),t._v(" "),s("h3",{attrs:{id:"_2-3-解决问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-解决问题"}},[t._v("#")]),t._v(" 2.3.解决问题")]),t._v(" "),s("p",[t._v("修改页面，对参数处理后发送：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526181301670.png",alt:"1526181301670"}})]),t._v(" "),s("p",[t._v("然后再次发起请求：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526181331443.png",alt:"1526181331443"}})]),t._v(" "),s("p",[t._v("发现请求成功：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526181358204.png",alt:"1526181358204"}})]),t._v(" "),s("p",[t._v("参数格式：")]),t._v(" "),s("p",[s("img",{attrs:{src:"F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526181384653.png",alt:"1526181384653"}})]),t._v(" "),s("p",[t._v("数据库：")]),t._v(" "),s("p",[s("img",{attrs:{src:"",alt:"1526181553737"}})])])}),[],!1,null,null,null);s.default=p.exports}}]);