<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1、异步查询工具axios | hwf&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/blog/img/icon.jpg">
    <link rel="stylesheet" href="/blog/css/style.css">
    <meta name="description" content="

异步查询数据，自然是通过ajax查询，大家首先想起的肯定是jQuery。但jQuery与MVVM的思想不吻合，而且ajax只是jQuery的一小部分。因此不可能为了发起ajax请求而去引用这么大的一个库。

1.1axios入门

Vue官方推荐的ajax请求框架叫做：axios，看下demo：

![1526033988251](F:\视频+笔记+资料\7乐优商城\day06-后台管 ...">
    
    <link rel="preload" href="/blog/assets/css/0.styles.a7bd39b5.css" as="style"><link rel="preload" href="/blog/assets/js/app.4d3b3729.js" as="script"><link rel="preload" href="/blog/assets/js/4.53f59e22.js" as="script"><link rel="preload" href="/blog/assets/js/1.3e289a8e.js" as="script"><link rel="preload" href="/blog/assets/js/22.7f01c7aa.js" as="script"><link rel="prefetch" href="/blog/assets/js/100.aeb8d516.js"><link rel="prefetch" href="/blog/assets/js/11.0400063b.js"><link rel="prefetch" href="/blog/assets/js/12.24aea172.js"><link rel="prefetch" href="/blog/assets/js/13.6ea8a656.js"><link rel="prefetch" href="/blog/assets/js/14.fdad2801.js"><link rel="prefetch" href="/blog/assets/js/15.e8c6836d.js"><link rel="prefetch" href="/blog/assets/js/16.7adf8965.js"><link rel="prefetch" href="/blog/assets/js/17.06d969f1.js"><link rel="prefetch" href="/blog/assets/js/18.bdcdef1f.js"><link rel="prefetch" href="/blog/assets/js/19.4626c64b.js"><link rel="prefetch" href="/blog/assets/js/2.cad01061.js"><link rel="prefetch" href="/blog/assets/js/20.4992eeab.js"><link rel="prefetch" href="/blog/assets/js/21.7ad5eb5b.js"><link rel="prefetch" href="/blog/assets/js/23.8bccbb22.js"><link rel="prefetch" href="/blog/assets/js/24.210a8785.js"><link rel="prefetch" href="/blog/assets/js/25.81b239da.js"><link rel="prefetch" href="/blog/assets/js/26.ede9394c.js"><link rel="prefetch" href="/blog/assets/js/27.6aad9c68.js"><link rel="prefetch" href="/blog/assets/js/28.21f51828.js"><link rel="prefetch" href="/blog/assets/js/29.8dc7dbb4.js"><link rel="prefetch" href="/blog/assets/js/3.20ac2743.js"><link rel="prefetch" href="/blog/assets/js/30.064af294.js"><link rel="prefetch" href="/blog/assets/js/31.290b3f96.js"><link rel="prefetch" href="/blog/assets/js/32.ff2523db.js"><link rel="prefetch" href="/blog/assets/js/33.1e080a80.js"><link rel="prefetch" href="/blog/assets/js/34.9370e5f1.js"><link rel="prefetch" href="/blog/assets/js/35.05b7e609.js"><link rel="prefetch" href="/blog/assets/js/36.cb4fe992.js"><link rel="prefetch" href="/blog/assets/js/37.84f5aa7d.js"><link rel="prefetch" href="/blog/assets/js/38.4cc324b9.js"><link rel="prefetch" href="/blog/assets/js/39.588f36cb.js"><link rel="prefetch" href="/blog/assets/js/40.3682b3b7.js"><link rel="prefetch" href="/blog/assets/js/41.347485fc.js"><link rel="prefetch" href="/blog/assets/js/42.f5edfe8a.js"><link rel="prefetch" href="/blog/assets/js/43.968b582b.js"><link rel="prefetch" href="/blog/assets/js/44.bbfde04d.js"><link rel="prefetch" href="/blog/assets/js/45.d888f364.js"><link rel="prefetch" href="/blog/assets/js/46.283b1b6f.js"><link rel="prefetch" href="/blog/assets/js/47.03e3d1b9.js"><link rel="prefetch" href="/blog/assets/js/48.96fe0bb8.js"><link rel="prefetch" href="/blog/assets/js/49.8b60382a.js"><link rel="prefetch" href="/blog/assets/js/5.8c869777.js"><link rel="prefetch" href="/blog/assets/js/50.35f729d8.js"><link rel="prefetch" href="/blog/assets/js/51.7abf39f1.js"><link rel="prefetch" href="/blog/assets/js/52.3f56cbd3.js"><link rel="prefetch" href="/blog/assets/js/53.12ebdfd5.js"><link rel="prefetch" href="/blog/assets/js/54.9642e33b.js"><link rel="prefetch" href="/blog/assets/js/55.57fc4c80.js"><link rel="prefetch" href="/blog/assets/js/56.ed55540e.js"><link rel="prefetch" href="/blog/assets/js/57.1849a2b7.js"><link rel="prefetch" href="/blog/assets/js/58.3cdd054a.js"><link rel="prefetch" href="/blog/assets/js/59.5844bd5c.js"><link rel="prefetch" href="/blog/assets/js/6.a36a5a51.js"><link rel="prefetch" href="/blog/assets/js/60.1b88e113.js"><link rel="prefetch" href="/blog/assets/js/61.dad37c4e.js"><link rel="prefetch" href="/blog/assets/js/62.5ac88c75.js"><link rel="prefetch" href="/blog/assets/js/63.6ae9c853.js"><link rel="prefetch" href="/blog/assets/js/64.4ff56248.js"><link rel="prefetch" href="/blog/assets/js/65.b29d861a.js"><link rel="prefetch" href="/blog/assets/js/66.b4b9bc81.js"><link rel="prefetch" href="/blog/assets/js/67.855d46c4.js"><link rel="prefetch" href="/blog/assets/js/68.9dff4eb3.js"><link rel="prefetch" href="/blog/assets/js/69.7aa8a86d.js"><link rel="prefetch" href="/blog/assets/js/7.bb47ed10.js"><link rel="prefetch" href="/blog/assets/js/70.6d93aef4.js"><link rel="prefetch" href="/blog/assets/js/71.63936a2b.js"><link rel="prefetch" href="/blog/assets/js/72.6019ff9b.js"><link rel="prefetch" href="/blog/assets/js/73.94baec68.js"><link rel="prefetch" href="/blog/assets/js/74.4d0b5d1d.js"><link rel="prefetch" href="/blog/assets/js/75.6ce45d15.js"><link rel="prefetch" href="/blog/assets/js/76.7e80c38f.js"><link rel="prefetch" href="/blog/assets/js/77.a0a241fd.js"><link rel="prefetch" href="/blog/assets/js/78.207a4b80.js"><link rel="prefetch" href="/blog/assets/js/79.34a553e8.js"><link rel="prefetch" href="/blog/assets/js/8.fde1d220.js"><link rel="prefetch" href="/blog/assets/js/80.306e3e7e.js"><link rel="prefetch" href="/blog/assets/js/81.aa14aab6.js"><link rel="prefetch" href="/blog/assets/js/82.9b56ac19.js"><link rel="prefetch" href="/blog/assets/js/83.da4f1c96.js"><link rel="prefetch" href="/blog/assets/js/84.5d2d7471.js"><link rel="prefetch" href="/blog/assets/js/85.d670156e.js"><link rel="prefetch" href="/blog/assets/js/86.e2032691.js"><link rel="prefetch" href="/blog/assets/js/87.393412a8.js"><link rel="prefetch" href="/blog/assets/js/88.284c2058.js"><link rel="prefetch" href="/blog/assets/js/89.f67dc91a.js"><link rel="prefetch" href="/blog/assets/js/90.64154314.js"><link rel="prefetch" href="/blog/assets/js/91.b69cd186.js"><link rel="prefetch" href="/blog/assets/js/92.e3d2e23b.js"><link rel="prefetch" href="/blog/assets/js/93.cc14d441.js"><link rel="prefetch" href="/blog/assets/js/94.ee2539d3.js"><link rel="prefetch" href="/blog/assets/js/95.0139a222.js"><link rel="prefetch" href="/blog/assets/js/96.00c712c9.js"><link rel="prefetch" href="/blog/assets/js/97.2cbbe1db.js"><link rel="prefetch" href="/blog/assets/js/98.3cc4af81.js"><link rel="prefetch" href="/blog/assets/js/99.55a7cf38.js"><link rel="prefetch" href="/blog/assets/js/vuejs-paginate.5c82ad01.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.a7bd39b5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/blog/" class="nav-link home-link">hwf's blog </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/blog/" class="nav-link">Blog</a></li><li class="nav-item"><a href="/blog/tag/" class="nav-link">Tags</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/blog/" class="nav-link mobile-home-link">hwf's blog </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/blog/" class="nav-link">Blog</a></li><li class="mobile-nav-item"><a href="/blog/tag/" class="nav-link">Tags</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        
      </h1> <div class="post-meta"><!----> <!----> <!----></div></header> <div itemprop="articleBody" class="content__default"><h2 id="_1、异步查询工具axios"><a href="#_1、异步查询工具axios" class="header-anchor">#</a> 1、异步查询工具axios</h2> <p>异步查询数据，自然是通过ajax查询，大家首先想起的肯定是jQuery。但jQuery与MVVM的思想不吻合，而且ajax只是jQuery的一小部分。因此不可能为了发起ajax请求而去引用这么大的一个库。</p> <h3 id="_1-1axios入门"><a href="#_1-1axios入门" class="header-anchor">#</a> 1.1axios入门</h3> <p>Vue官方推荐的ajax请求框架叫做：axios，看下demo：</p> <p><img src="F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526033988251.png" alt="1526033988251"></p> <p>axios的Get请求语法：</p> <div class="language-js extra-class"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/item/category/list?pid=0&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 请求路径和请求参数拼接</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    	<span class="token comment">// 成功回调函数</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    	<span class="token comment">// 失败回调函数</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 参数较多时，可以通过params来传递参数</span>
axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/item/category/list&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">params</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token literal-property property">pid</span><span class="token operator">:</span><span class="token number">0</span>
        <span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">// 成功时的回调</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">// 失败时的回调</span>
</code></pre></div><p>axios的POST请求语法：</p> <p>比如新增一个用户</p> <div class="language-js extra-class"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/user&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    	<span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;Jack&quot;</span><span class="token punctuation">,</span>
    	<span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">21</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>注意，POST请求传参，不需要像GET请求那样定义一个对象，在对象的params参数中传参。post()方法的第二个参数对象，就是将来要传递的参数</li></ul> <p>PUT和DELETE请求与POST请求类似</p> <h3 id="_1-2axios的全局配置"><a href="#_1-2axios的全局配置" class="header-anchor">#</a> 1.2axios的全局配置</h3> <p>而在我们的项目中，已经引入了axios，并且进行了简单的封装，在src下的http.js中：</p> <p><img src="F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526034150067.png" alt="1526034150067"></p> <p>http.js中对axios进行了一些默认配置：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>
<span class="token keyword">import</span> config <span class="token keyword">from</span> <span class="token string">'./config'</span>
<span class="token comment">// config中定义的基础路径是：http://api.leyou.com/api</span>
axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> config<span class="token punctuation">.</span>api<span class="token punctuation">;</span> <span class="token comment">// 设置axios的基础请求路径</span>
axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">2000</span><span class="token punctuation">;</span> <span class="token comment">// 设置axios的请求时间</span>

<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$http <span class="token operator">=</span> axios<span class="token punctuation">;</span><span class="token comment">// 将axios赋值给Vue原型的$http属性，这样所有vue实例都可使用该对象</span>

</code></pre></div><ul><li><p>http.js中导入了config的配置，还记得吗？</p> <p><img src="F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526041205846.png" alt="1526041205846"></p></li> <li><p>http.js对axios进行了全局配置：<code>baseURL=config.api</code>，即<code>http://api.leyou.com/api</code>。因此以后所有用axios发起的请求，都会以这个地址作为前缀。</p></li> <li><p>通过<code>Vue.property.$http = axios</code>，将<code>axios</code>赋值给了 Vue原型中的<code>$http</code>。这样以后所有的Vue实例都可以访问到$http，也就是访问到了axios了。</p></li></ul> <h3 id="_1-3测试一下"><a href="#_1-3测试一下" class="header-anchor">#</a> 1.3测试一下：</h3> <p>我们在组件<code>MyBrand.vue</code>的getDataFromServer方法，通过$http发起get请求，测试查询品牌的接口，看是否能获取到数据：</p> <p><img src="F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526048079191.png" alt="1526048221750"></p> <p>网络监视：</p> <p><img src="F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526048143014.png" alt="1526048143014"></p> <p>控制台结果：</p> <p><img src="F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526048275064.png" alt="1526048275064"></p> <p>可以看到，在请求成功的返回结果response中，有一个data属性，里面就是真正的响应数据。</p> <p>响应结果中与我们设计的一致，包含3个内容：</p> <ul><li>total：总条数，目前是165</li> <li>items：当前页数据</li> <li>totalPage：总页数，我们没有返回</li></ul> <h3 id="_1-4异步加载品牌数据"><a href="#_1-4异步加载品牌数据" class="header-anchor">#</a> 1.4异步加载品牌数据</h3> <p>虽然已经通过ajax请求获取了品牌数据，但是刚才的请求没有携带任何参数，这样显然不对。我们后端接口需要5个参数：</p> <ul><li>page：当前页，int</li> <li>rows：每页大小，int</li> <li>sortBy：排序字段，String</li> <li>desc：是否为降序，boolean</li> <li>key：搜索关键词，String</li></ul> <p>而页面中分页信息应该是在pagination对象中，我们通过浏览器工具，查看pagination中有哪些属性：</p> <p><img src="F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526042136135.png" alt=""></p> <p>分别是：</p> <ul><li>descending：是否是降序，对应请求参数的desc</li> <li>page：当前页，对应参数的page</li> <li>rowsPerpage：每页大小，对应参数中的rows</li> <li>sortBy：排序字段，对应参数的sortBy</li></ul> <p>缺少一个搜索关键词，这个应该是通过v-model与输入框绑定的属性：search。这样，所有参数就都有了。</p> <p>另外，不要忘了把查询的结果赋值给brands和totalBrands属性，Vuetify会帮我们渲染页面。</p> <p>接下来，我们完善请求参数：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 发起请求</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/item/brand/page&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
        <span class="token literal-property property">params</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>search<span class="token punctuation">,</span> <span class="token comment">// 搜索条件</span>
            <span class="token literal-property property">page</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pagination<span class="token punctuation">.</span>page<span class="token punctuation">,</span><span class="token comment">// 当前页</span>
            <span class="token literal-property property">rows</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pagination<span class="token punctuation">.</span>rowsPerPage<span class="token punctuation">,</span><span class="token comment">// 每页大小</span>
            <span class="token literal-property property">sortBy</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pagination<span class="token punctuation">.</span>sortBy<span class="token punctuation">,</span><span class="token comment">// 排序字段</span>
            <span class="token literal-property property">desc</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pagination<span class="token punctuation">.</span>descending<span class="token comment">// 是否降序</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">resp</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 这里使用箭头函数</span>
        <span class="token comment">// 将得到的数据赋值给本地属性</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>brands <span class="token operator">=</span> resp<span class="token punctuation">.</span>data<span class="token punctuation">.</span>items<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>totalBrands <span class="token operator">=</span> resp<span class="token punctuation">.</span>data<span class="token punctuation">.</span>total<span class="token punctuation">;</span>
        <span class="token comment">// 完成赋值后，把加载状态赋值为false</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>查看网络请求：</p> <p><img src="F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526049810351.png" alt="1526049810351"></p> <p>效果：</p> <p><img src="F:%5C%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99%5C7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%5Cday06-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%5Cassets%5C1526049139244.png" alt="1526049139244"></p> <h2 id="_2、请求参数格式错误"><a href="#_2、请求参数格式错误" class="header-anchor">#</a> 2、请求参数格式错误</h2> <h3 id="_2-1原因分析"><a href="#_2-1原因分析" class="header-anchor">#</a> 2.1原因分析</h3> <p>我们填写表单并提交，发现报错了：</p> <p><img src="F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526180888663.png" alt="1526180888663"></p> <p>查看控制台的请求详情：</p> <p><img src="F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526180937974.png" alt="1526180937974"></p> <p>发现请求的数据格式是JSON格式。</p> <blockquote><p>原因分析：</p></blockquote> <p>axios处理请求体的原则会根据请求数据的格式来定：</p> <ul><li><p>如果请求体是对象：会转为json发送</p></li> <li><p>如果请求体是String：会作为普通表单请求发送，但需要我们自己保证String的格式是键值对。</p> <p>如：name=jack&amp;age=12</p></li></ul> <h3 id="_2-2-qs工具"><a href="#_2-2-qs工具" class="header-anchor">#</a> 2.2.QS工具</h3> <p>QS是一个第三方库，我们可以用<code>npm install qs --save</code>来安装。不过我们在项目中已经集成了，大家无需安装：</p> <p><img src="F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526181889564.png" alt="1526181889564"></p> <p>这个工具的名字：QS，即Query String，请求参数字符串。</p> <p>什么是请求参数字符串？例如： name=jack&amp;age=21</p> <p>QS工具可以便捷的实现 JS的Object与QueryString的转换。</p> <p>在我们的项目中，将QS注入到了Vue的原型对象中，我们可以通过<code>this.$qs</code>来获取这个工具：</p> <p>我们将<code>this.$qs</code>对象打印到控制台：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$qs<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>发现其中有3个方法：</p> <p><img src="F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526181747560.png" alt="1526181747560"></p> <p>这里我们要使用的方法是stringify，它可以把Object转为QueryString。</p> <p>测试一下，使用浏览器工具，把qs对象保存为一个临时变量：</p> <p><img src="F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526182053758.png" alt="1526182053758"></p> <p>然后调用stringify方法：</p> <p><img src="F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526182230872.png" alt="1526182230872"></p> <p>成功将person对象变成了 name=jack&amp;age=21的字符串了</p> <h3 id="_2-3-解决问题"><a href="#_2-3-解决问题" class="header-anchor">#</a> 2.3.解决问题</h3> <p>修改页面，对参数处理后发送：</p> <p><img src="F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526181301670.png" alt="1526181301670"></p> <p>然后再次发起请求：</p> <p><img src="F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526181331443.png" alt="1526181331443"></p> <p>发现请求成功：</p> <p><img src="F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526181358204.png" alt="1526181358204"></p> <p>参数格式：</p> <p><img src="F:/%E8%A7%86%E9%A2%91+%E7%AC%94%E8%AE%B0+%E8%B5%84%E6%96%99/7%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E/day08-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86/assets/1526181384653.png" alt="1526181384653"></p> <p>数据库：</p> <p><img src="" alt="1526181553737"></p></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#_1、异步查询工具axios" title="1、异步查询工具axios">1、异步查询工具axios</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_1-1axios入门" title="1.1axios入门">1.1axios入门</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_1-2axios的全局配置" title="1.2axios的全局配置">1.2axios的全局配置</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_1-3测试一下" title="1.3测试一下：">1.3测试一下：</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_1-4异步加载品牌数据" title="1.4异步加载品牌数据">1.4异步加载品牌数据</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#_2、请求参数格式错误" title="2、请求参数格式错误">2、请求参数格式错误</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_2-1原因分析" title="2.1原因分析">2.1原因分析</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_2-2-qs工具" title="2.2.QS工具">2.2.QS工具</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_2-3-解决问题" title="2.3.解决问题">2.3.解决问题</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.4d3b3729.js" defer></script><script src="/blog/assets/js/4.53f59e22.js" defer></script><script src="/blog/assets/js/1.3e289a8e.js" defer></script><script src="/blog/assets/js/22.7f01c7aa.js" defer></script>
  </body>
</html>
